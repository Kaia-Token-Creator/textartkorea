<!DOCTYPE html>
<html lang="ko">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-93TFLCBY3F"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-93TFLCBY3F');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9891583086388017" crossorigin="anonymous"></script>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>텍스트 아트 생성기 - textartkorea.com</title>

<!-- favicon -->
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- Open Graph -->
<meta name="description" content="이미지를 텍스트 아트로 만들어보세요">
<meta property="og:type" content="website">
<meta property="og:title" content="텍스트 아트 생성기 - textartkorea.com">
<meta property="og:description" content="이미지를 텍스트 아트로 만들어보세요">
<meta property="og:site_name" content="textartkorea.com">
<meta property="og:image" content="https://textartkorea.com/preview.jpg">
<meta property="og:url" content="https://textartkorea.com">

<style>
  :root{
    --bg:#0b0f14; --panel:#111823; --text:#e5eef7; --muted:#94a3b8; --accent:#4f9cf9; --border:#1e293b
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace
  }
  .wrap{max-width:940px;margin:0 auto;padding:16px}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:8px}
  .title{font-weight:800;font-size:18px}
  .sharebar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .panel{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:14px}
  .grid{display:grid;gap:12px}
  @media(min-width:960px){.grid{grid-template-columns:360px 1fr}}

  /* 업로드 영역 */
  .drop{
    border:2px dashed #334155;border-radius:12px;padding:18px;text-align:center;
    background:#0f172a55; cursor:pointer; user-select:none
  }
  .drop:hover{border-color:var(--accent)}
  .drop strong.underline{ text-decoration: underline; }

  .hint{color:var(--muted);font-size:12px}
  .notice{margin-top:10px;padding:10px;border:1px dashed #2b3b55;border-radius:10px;background:#0f172a88}

  /* 컨트롤 - 한 줄에 하나씩 */
  .control{
    display:flex; flex-direction:column; gap:8px;
    margin:12px 0; padding:10px; border:1px solid var(--border); border-radius:10px; background:#0f172a66
  }
  .control label{font-size:12px;color:var(--muted)}
  .control input[type="range"], .control select, .control input[type="color"], .control input[type="text"]{width:100%}

  .btns{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
  button{
    background:#1e293b;color:#dbeafe;border:1px solid #2b3b55;
    padding:11px 14px;border-radius:10px;font-weight:700;cursor:pointer
  }
  button.primary{background:linear-gradient(180deg,#3b82f6,#2563eb);color:#fff}
  button:disabled{opacity:.55;cursor:not-allowed}
  .iconbtn{display:inline-flex;align-items:center;gap:6px}

  pre#ascii{
    margin:0; white-space:pre; overflow:auto; background:#000; color:#fff;
    padding:12px; border-radius:12px; line-height:1em; min-height:200px
  }

  /* ✅ 메시지를 마지막 줄 '아래' 우측 정렬로 표시 */
  .msg-below{
    margin-top:6px;
    text-align:right;
    font-weight:700;
    color:#fff;
    white-space:pre;
  }

  /* 모바일 여백 조금 더 */
  @media(max-width:480px){
    .control{margin:10px 0; padding:10px}
    .btns{gap:10px}
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">🔤 텍스트 아트 생성기</div>
    <div class="sharebar">
      <button id="shareSite" class="iconbtn">📤 친구에게 공유</button>
    </div>
  </header>

<a href="https://iryan.kr/t7372qwd34" target="_blank" rel="noopener noreferrer">
  <img
    src="https://img.tenping.kr/Content/Upload/Content/2019062812440001_Con_20220105155617_6.png?RS=640x200"
    alt="프로모션 배너"
    style="max-width:100%; height:auto; display:block; border:0; margin:0 auto;"
    loading="lazy"
    decoding="async"
  />
</a>


  <div class="grid">
    <!-- 좌측: 컨트롤 -->
    <div class="panel">
      <!-- 숨김 파일 입력 -->
      <input id="file" type="file" accept="image/*" style="display:none">

      <!-- 업로드 영역 (더블 선택 방지: label 제거, div 클릭/키보드로만 트리거) -->
      <div class="drop" id="drop" role="button" tabindex="0" aria-label="이미지를 드롭하거나 여기를 탭하여 업로드">
        <div><strong>이미지 드롭</strong>하거나 <strong class="underline">여기를 탭하여 업로드</strong></div>
        <div class="hint">클립보드에서 붙여넣기도 가능</div>
      </div>

      <div class="notice">💡 <strong>이미지로 저장해야 예쁘게 보여요.</strong> 카톡은 폰트가 달라 줄맞춤이 깨질 수 있어요. 모바일에선 50열 이하 권장.</div>

      <!-- 컨트롤: 각 항목 한 줄 -->
      <div class="control">
        <label>출력 폭: <span id="wVal">50</span>열</label>
        <input id="width" type="range" min="30" max="300" value="50">
      </div>

      <div class="control">
        <label>폰트 크기: <span id="fsVal">12</span>px</label>
        <input id="fontsize" type="range" min="8" max="20" value="12">
      </div>

      <div class="control">
        <label for="mode">모드</label>
        <select id="mode">
          <option value="mono" selected>흑백</option>
          <option value="color">컬러</option>
        </select>
      </div>

      <div class="control">
        <label for="fontColor">폰트 색상(흑백)</label>
        <input id="fontColor" type="color" value="#ffffff">
      </div>

      <div class="control">
        <label for="bgColor">배경 색상</label>
        <input id="bgColor" type="color" value="#000000">
      </div>

      <!-- 🔹 사용자 메시지: 최대 10글자, 우측 하단 출력 -->
      <div class="control">
        <label for="customMsg">메시지 (최대 10글자까지 입력 가능. 우측 하단 출력)</label>
        <input id="customMsg" type="text" maxlength="10" placeholder="메시지 입력">
      </div>

      <div class="btns">
        <button id="render" class="primary" disabled>만들기</button>
        <button id="copyBtn" class="iconbtn" disabled>📋 복사</button>
        <button id="shareImage" disabled>이미지 공유</button>
        <button id="savePng" disabled>이미지 저장</button>
        <button id="clear">초기화</button>
      </div>
    </div>

    <!-- 우측: 미리보기/출력 -->
    <div class="panel">
      <div id="preview" style="margin-bottom:8px"></div>
      <pre id="ascii"></pre>
      <!-- ✅ 메시지를 ASCII 아래, 우측 정렬로 별도 표시 -->
      <div id="msgBelow" class="msg-below"></div>
    </div>
  </div>
</div>

<!-- 내부 처리용 캔버스 -->
<canvas id="canvas" style="display:none"></canvas>

<script>
// ===== 유틸 & 보정 =====
function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }
function hexToRgb(hex){
  const m = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  if(!m) return {r:255,g:255,b:255};
  return { r: parseInt(m[1],16), g: parseInt(m[2],16), b: parseInt(m[3],16) };
}
function rgbToHex(r,g,b){
  const h = n => ('0'+clamp(n|0,0,255).toString(16)).slice(-2);
  return `#${h(r)}${h(g)}${h(b)}`;
}
// 컬러 저장 시 살짝 더 밝게 (sRGB 감마 보정)
function brighten(hex, gain=1.15){
  const {r,g,b} = hexToRgb(hex);
  const toLin = c => Math.pow(c/255, 2.2);
  const toSrgb = c => Math.pow(c, 1/2.2)*255;
  let rl = toLin(r), gl = toLin(g), bl = toLin(b);
  rl = clamp(rl*gain,0,1); gl = clamp(gl*gain,0,1); bl = clamp(bl*gain,0,1);
  return rgbToHex(toSrgb(rl), toSrgb(gl), toSrgb(bl));
}

// ===== 엘리먼트 =====
const fileInput=document.getElementById('file');
const drop=document.getElementById('drop');
const preview=document.getElementById('preview');
const asciiPre=document.getElementById('ascii');
const msgBelowEl=document.getElementById('msgBelow');
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d',{willReadFrequently:true});

const widthRange=document.getElementById('width');
const fontsizeRange=document.getElementById('fontsize');
const wVal=document.getElementById('wVal');
const fsVal=document.getElementById('fsVal');

const modeSel=document.getElementById('mode');
const fontColorInp=document.getElementById('fontColor');
const bgColorInp=document.getElementById('bgColor');
const customMsgInp=document.getElementById('customMsg');

const btnRender=document.getElementById('render');
const btnCopy=document.getElementById('copyBtn');
const btnSavePng=document.getElementById('savePng');
const btnShareImage=document.getElementById('shareImage');
const btnClear=document.getElementById('clear');
const btnShareSite=document.getElementById('shareSite');

let img=null;
let latestAsciiText='';
let latestColorGrid=null; // 컬러 모드일 때 문자 색상 저장
const CHARSET="@%#*+=-:. ";

// ===== 파일 읽기 / 업로드 핸들러 =====
function readFile(file){
  if(!file) return;
  const url=URL.createObjectURL(file);
  const image=new Image();
  image.onload=()=>{
    img=image;
    preview.innerHTML=`<img src="${url}" style="max-width:100%;border-radius:8px;border:1px solid #1e293b">`;
    btnRender.disabled=false;
    asciiPre.innerHTML='';
    msgBelowEl.textContent='';
    latestAsciiText=''; latestColorGrid=null;
  };
  image.onerror=()=>alert('이미지를 불러오지 못했습니다.');
  image.src=url;
}
drop.addEventListener('click',()=> fileInput.click());
drop.addEventListener('keydown',(e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); fileInput.click(); }});
fileInput.addEventListener('change',e=> readFile(e.target.files?.[0]));
['dragenter','dragover'].forEach(ev=> drop.addEventListener(ev,e=>{e.preventDefault(); e.stopPropagation();}));
drop.addEventListener('drop',e=>{e.preventDefault(); e.stopPropagation(); readFile(e.dataTransfer.files?.[0]);});
window.addEventListener('paste',e=>{
  const items=e.clipboardData?.items; if(!items) return;
  for(const it of items){ if(it.type.startsWith('image/')){ readFile(it.getAsFile()); break; } }
});

// ===== UI 표시값 =====
widthRange.addEventListener('input',()=> wVal.textContent = widthRange.value);
fontsizeRange.addEventListener('input',()=>{ fsVal.textContent = fontsizeRange.value; asciiPre.style.fontSize = fontsizeRange.value+'px'; });
modeSel.addEventListener('change',()=>{ fontColorInp.disabled = (modeSel.value==='color'); if(img) renderASCII(); });
fontColorInp.addEventListener('input',()=>{ if(latestAsciiText) { asciiPre.style.color = fontColorInp.value; msgBelowEl.style.color = fontColorInp.value; } });
bgColorInp.addEventListener('input',()=>{ if(latestAsciiText) asciiPre.style.background = bgColorInp.value; });

// ===== 핵심 렌더링 (미리보기) =====
function renderASCII(){
  if(!img) return;
  const targetCols=parseInt(widthRange.value,10);
  const fontSize=parseInt(fontsizeRange.value,10);
  const mode=modeSel.value; // 'mono' | 'color'
  const charAspect=2.0;

  // 리사이즈 후 샘플링
  const scale=targetCols/img.width;
  const targetRows=Math.max(1,Math.round(img.height*scale/charAspect));
  canvas.width=targetCols; canvas.height=targetRows;
  ctx.imageSmoothingEnabled=true; ctx.imageSmoothingQuality='high';
  ctx.drawImage(img,0,0,canvas.width,canvas.height);

  const {data,width,height}=ctx.getImageData(0,0,canvas.width,canvas.height);

  const lines=[]; const colorGrid=[];
  for(let y=0;y<height;y++){
    let line=''; const rowColors=[];
    for(let x=0;x<width;x++){
      const i=(y*width+x)*4;
      const r=data[i], g=data[i+1], b=data[i+2], a=data[i+3];
      const lum=0.2126*r + 0.7152*g + 0.0722*b;
      const t=clamp(lum/255,0,1);
      const idx=Math.round((1-t)*(CHARSET.length-1));
      const ch=CHARSET[idx]||' ';
      line+=ch;
      if(mode==='color'){
        const color=(a<10)? bgColorInp.value : rgbToHex(r,g,b);
        rowColors.push(color);
      }
    }
    lines.push(line);
    if(mode==='color') colorGrid.push(rowColors);
  }

  // === 워터마크: 마지막 줄 맨왼쪽 ===
  const domain="textartkorea.com";
  if(lines.length){
    const last=lines[lines.length-1];
    const cols=last.length;
    const replaced = domain + last.slice(domain.length);
    lines[lines.length-1] = replaced;
    if(mode==='color'){
      const rowIdx=lines.length-1;
      for(let c=0;c<Math.min(domain.length, cols); c++){
        colorGrid[rowIdx][c]='#ffffff';
      }
    }
  }else{
    lines.push(domain);
    if(mode==='color') colorGrid.push(domain.split('').map(()=> '#ffffff'));
  }

  // ✅ 사용자 메시지는 더 이상 마지막 줄에 끼우지 않음 — 아래 박스에 별도 표시
  const userMsg = (customMsgInp.value || '').slice(0,10);

  latestAsciiText=lines.join('\n');
  latestColorGrid=(mode==='color') ? colorGrid : null;

  // 화면 적용
  asciiPre.style.fontSize=fontSize+'px';
  asciiPre.style.background=bgColorInp.value;

  if(mode==='mono'){
    asciiPre.style.color=fontColorInp.value;
    asciiPre.textContent=latestAsciiText;
    msgBelowEl.style.color = fontColorInp.value;
  }else{
    const rowsHtml=[];
    for(let y=0;y<lines.length;y++){
      const chars=lines[y]; const colors=colorGrid[y];
      let html='';
      for(let x=0;x<chars.length;x++){
        const ch=chars[x];
        html += `<span style="color:${colors[x]}">${ch===' ' ? '&nbsp;' : ch}</span>`;
      }
      rowsHtml.push(html);
    }
    asciiPre.innerHTML=rowsHtml.join('<br>');
    msgBelowEl.style.color = '#ffffff';
  }

  // ✅ 메시지를 아래 박스에 우측 정렬로 표시
  msgBelowEl.textContent = userMsg || '';

  btnCopy.disabled=false;
  btnSavePng.disabled=false;
  btnShareImage.disabled=false;
}

// ===== PNG 빌드(저장/공유 공용) — 더 밝게 + 두껍게 + 메시지 아래 우측 정렬 =====
async function buildImageBlob(){
  if(!latestAsciiText) return null;

  const mode        = modeSel.value;
  const baseFont    = parseInt(fontsizeRange.value, 10);
  const fontColor   = fontColorInp.value;
  const bgColor     = bgColorInp.value;
  const userMsg     = (customMsgInp.value || '').slice(0,10);

  // 저장/공유 전용 고해상도 배율
  const SCALE_FACTOR = 2;

  const tmp  = document.createElement('canvas');
  const tctx = tmp.getContext('2d');
  const fontFamily = 'ui-monospace, SFMono-Regular, Menlo, Consolas, monospace';

  // 굵기 + 배율 적용
  const fontSize  = baseFont * SCALE_FACTOR;
  tctx.font       = `700 ${fontSize}px ${fontFamily}`; // 볼드로 더 두껍게
  const charWidth = tctx.measureText('M').width;

  const lines = latestAsciiText.split('\n');
  const cols  = Math.max(...lines.map(l => l.length));
  const rows  = lines.length;
  const pad   = Math.round(fontSize * 0.7);

  // ✅ 메시지 영역 높이 추가(있을 때만)
  const msgHeight = userMsg ? Math.ceil(fontSize * 1.3) : 0;

  tmp.width  = Math.ceil(pad + cols * charWidth + pad);
  tmp.height = Math.ceil(pad + rows * fontSize + pad + msgHeight);

  // 배경
  tctx.fillStyle = bgColor;
  tctx.fillRect(0, 0, tmp.width, tmp.height);
  tctx.font = `700 ${fontSize}px ${fontFamily}`;
  tctx.textBaseline = 'top';

  if (mode === 'mono') {
    // 흑백: 사용자가 고른 폰트색 + 두 번 찍기로 두께/밝기 체감 상승
    tctx.fillStyle = fontColor;
    for (let r = 0; r < rows; r++) {
      const y = pad + r * fontSize;
      tctx.fillText(lines[r], pad, y);
      tctx.fillText(lines[r], pad, y); // 겹쳐 찍기
    }
  } else {
    // 컬러: 저장시에만 컬러 밝기 보정 + 두 번 찍기
    for (let r = 0; r < rows; r++) {
      const chars  = lines[r];
      const colors = latestColorGrid[r];
      let x = pad;
      const y = pad + r * fontSize;
      for (let c = 0; c < chars.length; c++) {
        const bcol = brighten(colors[c], 1.15); // 조금 더 밝게
        tctx.fillStyle = bcol;
        tctx.fillText(chars[c], x, y);
        tctx.fillText(chars[c], x, y); // 겹쳐 찍기로 두께감
        x += charWidth;
      }
    }
  }

  // ✅ 메시지를 마지막 줄 '아래' 우측 정렬로 그리기 (있을 때만)
  if (userMsg) {
    tctx.fillStyle = (mode === 'mono') ? fontColor : '#ffffff';
    const msgWidth = tctx.measureText(userMsg).width;
    const x = Math.max(pad, tmp.width - pad - msgWidth); // 오른쪽 정렬
    const y = pad + rows * fontSize + Math.round(fontSize * 0.2); // 본문 아래 약간 여백
    tctx.fillText(userMsg, x, y);
    tctx.fillText(userMsg, x, y); // 두께감
  }

  return await new Promise(res => tmp.toBlob(res, 'image/png'));
}

// ===== 버튼 =====
btnRender.addEventListener('click',renderASCII);

btnCopy.addEventListener('click',async()=>{
  try{ await navigator.clipboard.writeText(latestAsciiText); alert('복사되었습니다!'); }
  catch(e){ alert('복사 실패. 브라우저 권한을 확인하세요.'); }
});

btnSavePng.addEventListener('click',async()=>{
  const blob=await buildImageBlob();
  if(!blob){ alert('먼저 만들기를 눌러 출력물을 생성하세요.'); return; }
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='text-art.png';
  a.click();
});

btnShareImage.addEventListener('click',async()=>{
  const blob=await buildImageBlob();
  if(!blob){ alert('먼저 만들기를 눌러 출력물을 생성하세요.'); return; }
  const file=new File([blob],'text-art.png',{type:'image/png'});
  if(navigator.canShare && navigator.canShare({files:[file]})){
    try{ await navigator.share({files:[file], title:'텍스트 아트', text:'텍스트 아트를 공유합니다.'}); }
    catch(e){ /* 취소 가능 */ }
  }else{
    const a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download='text-art.png';
    a.click();
    alert('이 브라우저는 이미지 공유를 지원하지 않아 다운로드로 대체했어요. 다운로드된 이미지를 공유해 주세요.');
  }
});

// 사이트 공유
btnShareSite.addEventListener('click',async()=>{
  const shareData={title:'텍스트 아트 생성기', text:'이미지를 텍스트 아트로 변환해보세요!', url:location.href};
  if(navigator.share){
    try{ await navigator.share(shareData); }catch(e){}
  }else{
    try{ await navigator.clipboard.writeText(location.href); alert('사이트 주소가 복사되었어요!'); }
    catch(e){ alert('공유 미지원 브라우저입니다. 주소를 직접 복사해 주세요: '+location.href); }
  }
});

// 초기화
btnClear.addEventListener('click',()=>{
  img=null; latestAsciiText=''; latestColorGrid=null;
  fileInput.value=''; preview.innerHTML=''; asciiPre.innerHTML=''; msgBelowEl.textContent='';
  btnRender.disabled=true; btnCopy.disabled=true; btnSavePng.disabled=true; btnShareImage.disabled=true;
});

// 이미지 로드 감지해서 '만들기' 활성화
const mo=new MutationObserver(()=>{btnRender.disabled=!img;});
mo.observe(preview,{childList:true});

// 초기 상태
wVal.textContent=widthRange.value;
fsVal.textContent=fontsizeRange.value;
fontColorInp.disabled = (modeSel.value==='color');
</script>

<footer>
  <p style="text-align:center; color:#666; font-size:14px;">© 2025 textartkorea.com</p>

<a href="https://iryan.kr/t73750ushf" target="_blank" rel="noopener noreferrer">
  <img
    src="https://img.tenping.kr/Content/Upload/Content/2025082015510001_Con_20250820160749_3.jpg?RS=720x1280"
    alt="프로모션 배너"
    style="max-width:100%; height:auto; display:block; border:0; margin:0 auto;"
    loading="lazy"
    decoding="async"
  />
</a>

</footer>
</body>
</html>
